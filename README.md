# Distribute Information Project

## 実用に不要かつ不向きで邪魔な追加モニター
- ここ最近発表される殆どの車載メーターは、マルチファンクション液晶パネルを標準装備しており、隣の芝生はなんだかピカピカしていて、少し羨ましいのです。そう、なんとなく羨ましい限りでカッコ良いのです。<br>
  このままにしておくのは少し寂しく、隣の芝生が羨ましいからと言っても隣の家を買うには懐がやはり寂しく、最大限の妥協として邪悪極りない追加モニターを設置しようした顛末を記します。
- 追記：<br>
　アナログ5連メータはとても気に入っていたのですが、この程、車両を乗り換えました。<br>
　フロントスクリーンを交換しても今回実装した2.0インチ液晶2枚を設置出来る場所が無さそうです。<br>
- 今後、液晶パネルの設置場所が決まったら再開する予定。
- 実行環境
　Wioterminal<br>
　　SPI(ST7789:240x320,2.0TFT x 2), I2C(BME280,MPU9250,PAJ7620,AMG8833), GROVE(GPS:for M5Stack)

  ![Panel動作中](https://user-images.githubusercontent.com/84197168/214604805-6baebaca-f720-4d4f-accd-9a2bfa9897cb.jpg)


# ビルド時の注意事項

以下を修正しないとビルド出来ないか、正しく動作しません。
* GPSデータのデコーダーとしてTinyGPSPlusを利用しています。（このライブラリはGPS全般が判らない私にとって、非常に有難いライブラリです！）<br>
  GPSセンサーから受信したGNRMC,GNGGA（NMEAフォーマット）データをデコードして貰っていますが、今回の実装では、今、まさにデコードしているGPSコマンドの種類が欲しかった為、ライブラリPrivateメンバを、Publicメンバに変更しています。（暫定で修正したままでした）

* パネル描画に、LovyanGFXを利用しています。<br>
　そもそもこのライブラリが無かったら、2枚のパネルに描画しようなんて考え付かなかったと思いますが、ある意味で沼にハマったきっかけとなったライブラリです。
　深く調べておりませんが、以下２つのソースについては、LovyanGFX-0.4-17版を利用しないとJPEG画像が描画されません。（広く利用されているライブラリだと思うので、単に私の環境が原因だと思っています）
  LobyanGFX/src/lgfx/utility/lgfx_tjpgd.c(.h)の2ファイルを0.4-17から持ってくる<br>

# 引用ソース
src/Thermo/MyThermoMatrix.cpp(.h) : "のるLAB"さんからの利用許可を得ています。

# 残念残件（やりかけで、実装・修正していない事項）
* 内部で利用している時刻情報を統一する。（現状はGPS由来と、millis()由来の２種類存在する）
* 停車状態に描画する、詳細情報を整理する（超適当で、正しい値を示しているのかすら怪しい）
* システムステータス情報の描画が消える。（再描画のフラグが問題ですが未修整）
* デバイス状態マーカーとデバイス状態を管理するクラスを整備すること（これが上の残念残件が未修整の理由）
* 高速化対応する（無駄なロジックを排除しつつ、Arduinoの関数の処理速度を体感で覚える）
* メインパネル側の速度が3桁になるとコンパス円周が一部消える件をそろそろ直したい。（描画順番を修正するだけ）
* そもそもBLEタスクのデバッグが甘く4時間程度連続運転すると落ちるが、恐らくスタックオーバー
* 一度作り込んだBLEタスクを元に戻す（TPMS情報を処理する）
